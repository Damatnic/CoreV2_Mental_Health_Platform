# ================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# Astral Core Mental Health Platform v2.0
# ================================================================
# 
# CRITICAL: This configuration is for PRODUCTION deployment
# Contains sensitive keys and should be kept secure
# Use environment-specific secrets management in production
#
# Last Updated: 2025-08-30
# ================================================================

# ================================
# ENVIRONMENT SETTINGS
# ================================
NODE_ENV=production
DEPLOYMENT_ENV=production
APP_VERSION=2.0.0
DEBUG=false
LOG_LEVEL=error

# ================================
# APPLICATION URLS
# ================================
VITE_APP_URL=https://astralcore.health
VITE_API_BASE_URL=https://api.astralcore.health/v2
VITE_WEBSOCKET_URL=wss://ws.astralcore.health
VITE_CDN_URL=https://cdn.astralcore.health

# Netlify-specific paths (when deployed on Netlify)
VITE_NETLIFY_API_URL=/.netlify/functions
VITE_NETLIFY_FUNCTIONS_URL=/.netlify/functions

# ================================
# DATABASE CONFIGURATION
# ================================
# Primary Database (Neon)
DATABASE_URL=postgresql://neondb_owner:npg_IrC1uWYi3FdA@ep-floral-lake-aeiztgic-pooler.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require
DATABASE_SSL=true
DATABASE_POOL_MIN=10
DATABASE_POOL_MAX=50
DATABASE_IDLE_TIMEOUT=60000
DATABASE_CONNECTION_TIMEOUT=15000
DATABASE_STATEMENT_TIMEOUT=30000
DATABASE_QUERY_TIMEOUT=20000

# Read Replica (if available)
DATABASE_READ_REPLICA_URL=${DATABASE_URL}
DATABASE_READ_REPLICA_POOL_MAX=30

# ================================
# REDIS CONFIGURATION (Production)
# ================================
REDIS_URL=redis://prod-redis.astralcore.health:6379
REDIS_PASSWORD=${REDIS_PASSWORD}  # Set via environment variable
REDIS_TLS=true
REDIS_DB=0
REDIS_KEY_PREFIX=astral:prod:
REDIS_CACHE_TTL=7200
REDIS_SESSION_TTL=86400
REDIS_CLUSTER_ENABLED=true

# ================================
# AI SERVICES - PRODUCTION KEYS
# ================================

# OpenAI GPT-4 (Production)
VITE_OPENAI_API_KEY=${OPENAI_API_KEY}  # Set via environment variable
VITE_OPENAI_ORG_ID=${OPENAI_ORG_ID}
VITE_OPENAI_MODEL=gpt-4-turbo
VITE_OPENAI_CRISIS_MODEL=gpt-4-turbo
VITE_OPENAI_MAX_TOKENS=2000
VITE_OPENAI_TEMPERATURE=0.7
VITE_OPENAI_TIMEOUT_MS=15000
VITE_OPENAI_RETRY_ATTEMPTS=3
VITE_OPENAI_RATE_LIMIT=100  # requests per minute

# Anthropic Claude (Production)
VITE_ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
VITE_ANTHROPIC_MODEL=claude-3-opus-20240229
VITE_ANTHROPIC_MAX_TOKENS=2000
VITE_ANTHROPIC_TEMPERATURE=0.6
VITE_ANTHROPIC_TIMEOUT_MS=15000
VITE_ANTHROPIC_RATE_LIMIT=60

# Google Gemini (Production)
VITE_GOOGLE_GEMINI_API_KEY=${GOOGLE_GEMINI_API_KEY}
VITE_GEMINI_MODEL=gemini-pro
VITE_GEMINI_SAFETY_THRESHOLD=BLOCK_MEDIUM_AND_ABOVE
VITE_GEMINI_MAX_TOKENS=2000
VITE_GEMINI_RATE_LIMIT=60

# Hugging Face (Production)
VITE_HUGGINGFACE_API_KEY=${HUGGINGFACE_API_KEY}
VITE_HF_FALLBACK_MODEL=microsoft/DialoGPT-large

# ================================
# CRISIS SERVICES - PRODUCTION
# ================================

# 988 Lifeline Production API
VITE_988_API_ENDPOINT=https://api.988lifeline.org/v2
VITE_988_API_KEY=${LIFELINE_988_API_KEY}
VITE_988_WEBHOOK_SECRET=${LIFELINE_988_WEBHOOK_SECRET}
VITE_988_AUTO_CONNECT_ENABLED=true
VITE_988_CONSENT_REQUIRED=true
VITE_988_PRIORITY_QUEUE=true

# Crisis Text Line Production
VITE_CRISIS_TEXT_API_KEY=${CRISIS_TEXT_API_KEY}
VITE_CRISIS_TEXT_NUMBER=741741
VITE_CRISIS_TEXT_WEBHOOK_URL=https://api.astralcore.health/webhooks/crisis-text
VITE_CRISIS_TEXT_PRIORITY_ENABLED=true

# Emergency Services Production
VITE_RAPIDSOS_API_KEY=${RAPIDSOS_API_KEY}
VITE_EMERGENCY_DISPATCH_URL=https://api.rapidsos.com/v1/emergency
VITE_EMERGENCY_WEBSOCKET_URL=wss://dispatch.rapidsos.com/ws
VITE_911_AUTO_DIAL_THRESHOLD=0.95
VITE_911_CONSENT_OVERRIDE=true  # For life-threatening situations

# Mental Health Services APIs
VITE_SAMHSA_API_KEY=${SAMHSA_API_KEY}
VITE_NAMI_API_KEY=${NAMI_API_KEY}

# ================================
# GOOGLE SERVICES - PRODUCTION
# ================================
VITE_GOOGLE_PLACES_API_KEY=${GOOGLE_PLACES_API_KEY}
VITE_GOOGLE_GEOCODING_API_KEY=${GOOGLE_GEOCODING_API_KEY}
VITE_GOOGLE_MAPS_API_KEY=${GOOGLE_MAPS_API_KEY}
VITE_GOOGLE_ANALYTICS_ID=${GA_TRACKING_ID}
VITE_GOOGLE_TAG_MANAGER_ID=${GTM_ID}

# ================================
# AUTHENTICATION & SECURITY
# ================================

# JWT Configuration (Production)
JWT_SECRET=${JWT_SECRET}  # Minimum 256-bit key
JWT_ALGORITHM=RS256  # Use RSA in production
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=https://api.astralcore.health
JWT_AUDIENCE=https://astralcore.health
JWT_PUBLIC_KEY_PATH=/secure/keys/jwt-public.pem
JWT_PRIVATE_KEY_PATH=/secure/keys/jwt-private.pem

# Session Configuration
SESSION_SECRET=${SESSION_SECRET}  # Minimum 256-bit key
SESSION_NAME=astral.sid
SESSION_MAX_AGE=3600000  # 1 hour
SESSION_SECURE=true
SESSION_SAME_SITE=strict
SESSION_HTTP_ONLY=true
SESSION_DOMAIN=.astralcore.health

# OAuth Production Providers
VITE_GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
VITE_GOOGLE_REDIRECT_URI=https://api.astralcore.health/auth/google/callback

VITE_APPLE_CLIENT_ID=${APPLE_CLIENT_ID}
APPLE_TEAM_ID=${APPLE_TEAM_ID}
APPLE_KEY_ID=${APPLE_KEY_ID}
APPLE_PRIVATE_KEY_PATH=/secure/keys/apple-signin.p8

# Auth0 Configuration
VITE_AUTH0_DOMAIN=${AUTH0_DOMAIN}
VITE_AUTH0_CLIENT_ID=${AUTH0_CLIENT_ID}
AUTH0_CLIENT_SECRET=${AUTH0_CLIENT_SECRET}
AUTH0_AUDIENCE=https://api.astralcore.health

# Encryption Keys (Production)
ENCRYPTION_KEY=${ENCRYPTION_KEY}  # 256-bit key
ENCRYPTION_IV=${ENCRYPTION_IV}  # 128-bit IV
CRYPTO_ALGORITHM=aes-256-gcm
ENCRYPTION_SALT=${ENCRYPTION_SALT}
BCRYPT_ROUNDS=12
KEY_ROTATION_ENABLED=true
KEY_ROTATION_INTERVAL=90  # days

# ================================
# COMMUNICATION SERVICES
# ================================

# Email (SendGrid Production)
SENDGRID_API_KEY=${SENDGRID_API_KEY}
EMAIL_FROM=support@astralcore.health
EMAIL_REPLY_TO=support@astralcore.health
EMAIL_VERIFICATION_URL=https://astralcore.health/verify-email
EMAIL_RESET_PASSWORD_URL=https://astralcore.health/reset-password
EMAIL_RATE_LIMIT=100  # per hour per user

# SMS (Twilio Production)
TWILIO_ACCOUNT_SID=${TWILIO_ACCOUNT_SID}
TWILIO_AUTH_TOKEN=${TWILIO_AUTH_TOKEN}
TWILIO_PHONE_NUMBER=${TWILIO_PHONE_NUMBER}
TWILIO_MESSAGING_SERVICE_SID=${TWILIO_MESSAGING_SERVICE_SID}
SMS_RATE_LIMIT=20  # per hour per user

# Push Notifications
VAPID_PUBLIC_KEY=${VAPID_PUBLIC_KEY}
VAPID_PRIVATE_KEY=${VAPID_PRIVATE_KEY}
VAPID_SUBJECT=mailto:admin@astralcore.health
FCM_SERVER_KEY=${FCM_SERVER_KEY}
APNS_KEY_ID=${APNS_KEY_ID}
APNS_TEAM_ID=${APNS_TEAM_ID}
APNS_KEY_PATH=/secure/keys/apns.p8

# WebRTC (Production)
VITE_WEBRTC_STUN_SERVER=stun:stun.astralcore.health:3478
VITE_WEBRTC_TURN_SERVER=turn:turn.astralcore.health:3478
VITE_WEBRTC_TURN_USERNAME=${TURN_USERNAME}
VITE_WEBRTC_TURN_PASSWORD=${TURN_PASSWORD}
VITE_WEBRTC_MAX_BANDWIDTH=2000  # kbps

# ================================
# MONITORING & OBSERVABILITY
# ================================

# Sentry (Production)
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1  # 10% sampling
SENTRY_PROFILES_SAMPLE_RATE=0.01  # 1% profiling
SENTRY_REPLAY_SESSION_SAMPLE_RATE=0.1
SENTRY_REPLAY_ON_ERROR_SAMPLE_RATE=1.0
SENTRY_RELEASE=${APP_VERSION}

# DataDog APM
DATADOG_API_KEY=${DATADOG_API_KEY}
DATADOG_APP_KEY=${DATADOG_APP_KEY}
DATADOG_SITE=datadoghq.com
DATADOG_ENV=production
DATADOG_SERVICE=astralcore-mental-health
DATADOG_VERSION=${APP_VERSION}

# New Relic
NEW_RELIC_LICENSE_KEY=${NEW_RELIC_LICENSE_KEY}
NEW_RELIC_APP_NAME=AstralCore-Production
NEW_RELIC_LOG_LEVEL=info

# Logging
LOG_FORMAT=json
LOG_DESTINATION=datadog,sentry,cloudwatch
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for HIPAA
CLOUDWATCH_LOG_GROUP=/aws/elasticbeanstalk/astralcore
CLOUDWATCH_LOG_STREAM=production

# ================================
# COMPLIANCE & SECURITY
# ================================

# HIPAA Compliance
HIPAA_AUDIT_ENABLED=true
HIPAA_ENCRYPTION_REQUIRED=true
HIPAA_DATA_RETENTION_DAYS=2555  # 7 years
HIPAA_ACCESS_LOG_ENABLED=true
HIPAA_BREACH_NOTIFICATION_EMAIL=compliance@astralcore.health
HIPAA_BAA_REQUIRED=true
HIPAA_MINIMUM_NECESSARY=true

# Security Headers
SECURITY_HSTS_ENABLED=true
SECURITY_HSTS_MAX_AGE=31536000  # 1 year
SECURITY_HSTS_INCLUDE_SUBDOMAINS=true
SECURITY_HSTS_PRELOAD=true
SECURITY_CSP_ENABLED=true
SECURITY_CSP_REPORT_URI=https://api.astralcore.health/csp-report
SECURITY_FRAME_OPTIONS=DENY
SECURITY_CONTENT_TYPE_OPTIONS=nosniff
SECURITY_XSS_PROTECTION=1; mode=block
SECURITY_REFERRER_POLICY=strict-origin-when-cross-origin

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AUTH_MAX=10
RATE_LIMIT_CRISIS_MAX=1000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false
RATE_LIMIT_STORE=redis

# CORS Configuration
CORS_ORIGINS=https://astralcore.health,https://www.astralcore.health
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# WAF Configuration
WAF_ENABLED=true
WAF_MODE=blocking
WAF_RULES=OWASP_CRS_3.0
DDoS_PROTECTION=true

# ================================
# FEATURE FLAGS - PRODUCTION
# ================================
ENABLE_2FA=true
ENABLE_OAUTH=true
ENABLE_ANONYMOUS_AUTH=true
ENABLE_BIOMETRIC_AUTH=true
ENABLE_AI_CRISIS_DETECTION=true
ENABLE_988_INTEGRATION=true
ENABLE_911_INTEGRATION=true
ENABLE_CRISIS_TEXT=true
ENABLE_WEBRTC_CALLING=true
ENABLE_LOCATION_SERVICES=true
ENABLE_PUSH_NOTIFICATIONS=true
ENABLE_SMS_NOTIFICATIONS=true
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_THERAPY_MATCHING=true
ENABLE_PEER_SUPPORT=true
ENABLE_TELETHERAPY=true
ENABLE_MEDICATION_TRACKING=true
ENABLE_MOOD_TRACKING=true
ENABLE_JOURNAL=true
ENABLE_SAFETY_PLAN=true
ENABLE_RESOURCE_LIBRARY=true
ENABLE_FORUM=true
ENABLE_CHAT=true
ENABLE_VIDEO_LIBRARY=true
ENABLE_MINDFULNESS=true
ENABLE_BREATHING_EXERCISES=true
ENABLE_SLEEP_TRACKING=true
ENABLE_SYMPTOM_TRACKING=true
ENABLE_GOAL_SETTING=true
ENABLE_PROGRESS_TRACKING=true
ENABLE_CERTIFICATES=true
ENABLE_GAMIFICATION=true
ENABLE_ACHIEVEMENTS=true
ENABLE_MULTILINGUAL=true
ENABLE_CULTURAL_ADAPTATION=true
ENABLE_ADMIN_DASHBOARD=true
ENABLE_ANALYTICS=true
ENABLE_A_B_TESTING=true
ENABLE_MAINTENANCE_MODE=false
ENABLE_DEBUG_MODE=false

# ================================
# CRISIS THRESHOLDS & SETTINGS
# ================================
VITE_CRISIS_AUTO_DIAL_THRESHOLD=0.90
VITE_EMERGENCY_ESCALATION_THRESHOLD=0.95
VITE_MONITORING_ALERT_THRESHOLD=0.70
VITE_AI_CONFIDENCE_THRESHOLD=0.80
VITE_HUMAN_REVIEW_THRESHOLD=0.60
VITE_AUTO_ESCALATION_ENABLED=true
VITE_REQUIRE_CONSENT_FOR_988=true
VITE_REQUIRE_CONSENT_FOR_911=false  # Override in emergencies
VITE_REQUIRE_CONSENT_FOR_LOCATION=true

# Fallback Emergency Services
VITE_FALLBACK_CRISIS_NUMBER=1-800-273-8255
VITE_FALLBACK_TEXT_NUMBER=741741
VITE_FALLBACK_EMERGENCY_NUMBER=911
VITE_FALLBACK_INTERNATIONAL_NUMBER=112

# ================================
# PERFORMANCE & OPTIMIZATION
# ================================
CDN_ENABLED=true
CDN_URL=https://cdn.astralcore.health
CDN_CACHE_CONTROL=public, max-age=31536000, immutable
IMAGE_OPTIMIZATION=true
IMAGE_CDN_URL=https://images.astralcore.health
LAZY_LOADING=true
CODE_SPLITTING=true
TREE_SHAKING=true
MINIFICATION=true
SOURCE_MAPS=false  # Disabled in production
GZIP_COMPRESSION=true
BROTLI_COMPRESSION=true

# Service Worker & PWA
SERVICE_WORKER_ENABLED=true
PWA_ENABLED=true
CACHE_STRATEGY=cache-first
CACHE_MAX_AGE=604800  # 1 week
CACHE_VERSION=v2.0.0
OFFLINE_FALLBACK_PAGE=/offline.html
OFFLINE_CRISIS_PAGE=/offline-crisis.html

# Performance Budgets
PERFORMANCE_BUDGET_JS=500  # KB
PERFORMANCE_BUDGET_CSS=100  # KB
PERFORMANCE_BUDGET_IMAGE=2000  # KB
PERFORMANCE_BUDGET_FONT=200  # KB
PERFORMANCE_BUDGET_TOTAL=3000  # KB

# ================================
# BACKUP & RECOVERY
# ================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM UTC
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=astralcore-backups-prod
BACKUP_S3_REGION=us-east-1
BACKUP_ENCRYPTION=true
BACKUP_ENCRYPTION_KEY=${BACKUP_ENCRYPTION_KEY}
DISASTER_RECOVERY_RTO=4  # hours
DISASTER_RECOVERY_RPO=1  # hour
POINT_IN_TIME_RECOVERY=true

# ================================
# DEPLOYMENT & SCALING
# ================================
DEPLOYMENT_STRATEGY=blue-green
ROLLBACK_ON_ERROR=true
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/alive
STARTUP_PROBE_DELAY=30
GRACEFUL_SHUTDOWN_TIMEOUT=30000

# Auto Scaling
AUTO_SCALING_ENABLED=true
MIN_INSTANCES=3
MAX_INSTANCES=20
TARGET_CPU_UTILIZATION=70
TARGET_MEMORY_UTILIZATION=75
SCALE_UP_COOLDOWN=60
SCALE_DOWN_COOLDOWN=300

# Load Balancing
LOAD_BALANCER_ALGORITHM=least_connections
STICKY_SESSIONS=true
SESSION_AFFINITY_TTL=3600

# ================================
# CLOUD PROVIDER CONFIGURATION
# ================================
CLOUD_PROVIDER=AWS  # or GCP, Azure
AWS_REGION=us-east-1
AWS_ACCOUNT_ID=${AWS_ACCOUNT_ID}
AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}

# S3 Configuration
S3_BUCKET_NAME=astralcore-assets
S3_REGION=us-east-1
S3_ENDPOINT=https://s3.amazonaws.com
S3_UPLOAD_TIMEOUT=60000
S3_MULTIPART_THRESHOLD=10485760  # 10MB

# CloudFront
CLOUDFRONT_DISTRIBUTION_ID=${CLOUDFRONT_DISTRIBUTION_ID}
CLOUDFRONT_DOMAIN=d1234567890.cloudfront.net

# ================================
# PAYMENT PROCESSING (if needed)
# ================================
STRIPE_PUBLIC_KEY=${STRIPE_PUBLIC_KEY}
STRIPE_SECRET_KEY=${STRIPE_SECRET_KEY}
STRIPE_WEBHOOK_SECRET=${STRIPE_WEBHOOK_SECRET}
PAYMENT_CURRENCY=USD
PAYMENT_TAX_RATE=0

# ================================
# THIRD-PARTY INTEGRATIONS
# ================================
ZOOM_API_KEY=${ZOOM_API_KEY}
ZOOM_API_SECRET=${ZOOM_API_SECRET}
SLACK_CLIENT_ID=${SLACK_CLIENT_ID}
SLACK_CLIENT_SECRET=${SLACK_CLIENT_SECRET}
DISCORD_CLIENT_ID=${DISCORD_CLIENT_ID}
DISCORD_CLIENT_SECRET=${DISCORD_CLIENT_SECRET}

# ================================
# END OF PRODUCTION CONFIGURATION
# ================================